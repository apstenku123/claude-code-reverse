/**
 * Factory function that creates an object with a 'get' method for property retrieval.
 * The 'get' method attempts to retrieve a property from the provided source object by key.
 * If the property is not found, isBlobOrFileLikeObject tries again using a fallback key generated by VF2.
 *
 * @param {Object} [sourceObject={}] - The object to retrieve properties from.
 * @returns {{ get: function(string): any }} An object with a 'get' method for property lookup.
 */
function createPropertyGetter(sourceObject) {
  /**
   * Retrieves a property value from the source object by key, with a fallback lookup.
   *
   * @param {string} propertyKey - The key of the property to retrieve.
   * @returns {*} The value of the property if found, otherwise undefined.
   */
  function getProperty(propertyKey) {
    const objectToSearch = sourceObject || {};
    // Attempt to retrieve the property directly
    let propertyValue = objectToSearch[propertyKey];
    // If not found, attempt to retrieve using the fallback key generated by VF2
    if (propertyValue === null || propertyValue === undefined) {
      propertyValue = objectToSearch[VF2(propertyKey)];
    }
    return propertyValue;
  }

  return {
    get: getProperty
  };
}

module.exports = createPropertyGetter;